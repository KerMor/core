function [ t,x ] = compute_trajectory(model, mu, inidx)
%COMPUTE_TRAJECTORY Summary of this function goes here
%   Detailed explanation goes here

% if nargin < 3
%     inidx = [];
% end
% if nargin < 2
%     mu = [];
% end

odefun = gen_odefun(model.system, mu, inidx);
x0 = model.system.x0(mu);
% Solve ODE
opts = odeset(
[t,x] = model.odesolver(odefun, model.times, x0);
end